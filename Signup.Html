<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>EventHub</title>
<link rel="icon" type="image/png" href="Logo.png">

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet"/>

<script id="tailwind-config">
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        primary: "#3366FF",
        teal: "#00C2A0",
        navy: "#0A1F44",
        gray: {
          text: "#6C757D",
          bg: "#E5E5E5"
        }
      },
      fontFamily: {
        display: ["Manrope", "sans-serif"],
      },
      borderRadius: {
        '3xl': '1.875rem',
      }
    }
  }
};
</script>

<style type="text/tailwindcss">
:root {
  --primary-gradient: linear-gradient(120deg, #3366FF 0%, #00C2A0 100%);
}
body {
  font-family: 'Manrope', sans-serif;
  background-color: #FFFFFF;
}
.bg-auth-gradient {
  background: var(--primary-gradient);
}
.selected-card {
  border: 2px solid #3366FF;
  box-shadow: 0 0 10px rgba(51,102,255,0.3);
}
</style>

<!-- =================== FIREBASE SDK =================== -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAdvds3EaIqAOk2JSW8tY7c_xTClj_Sqrk",
  authDomain: "eventhub-50898.firebaseapp.com",
  projectId: "eventhub-50898",
  storageBucket: "eventhub-50898.firebasestorage.app",
  messagingSenderId: "42079480129",
  appId: "1:42079480129:web:60886eca0db4e3b1bc59c0"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

document.addEventListener("DOMContentLoaded", function () {

  let selectedRole = "student";

  document.querySelectorAll(".role-card").forEach(card => {
    card.addEventListener("click", function () {

      document.querySelectorAll(".role-card")
        .forEach(c => c.classList.remove("selected-card"));

      this.classList.add("selected-card");
      selectedRole = this.getAttribute("data-role");
    });
  });

  const signupBtn = document.getElementById("signupBtn");

  signupBtn.addEventListener("click", async function (event) {

    event.preventDefault();  // ⬅️ CRITICAL FIX

    const name = document.getElementById("fullname").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const confirmPassword = document.getElementById("confirmPassword").value;

    if (!name || !email || !password || !confirmPassword) {
      alert("⚠ Please fill all fields!");
      return;
    }

    if (password !== confirmPassword) {
      alert("❌ Passwords do not match!");
      return;
    }

    signupBtn.disabled = true;
    signupBtn.innerText = "Please wait...";


    console.log("Attempting signup for:", email);

    try {
      const userCredential = await createUserWithEmailAndPassword(
        auth,
        email,
        password
      );

      const user = userCredential.user;

      console.log("User created:", user.uid);

      await setDoc(doc(db, "users", user.uid), {
        name: name,
        email: email,
        role: selectedRole,
        createdAt: new Date()
      });

       // Show success popup
           document.getElementById("successModal").classList.remove("hidden");

// ONE consistent redirect path for BOTH cases
        let redirectTimer = setTimeout(() => {
            window.location.href = "/Login.html";
          }, 8000);

          document.getElementById("goToLoginBtn").onclick = function () {
           clearTimeout(redirectTimer);
           window.location.href = "/Login.html";
          };




    } catch (error) {
      console.error("Signup Error:", error);

      alert("❌ Signup Failed:\n" + error.code + "\n" + error.message);

      signupBtn.disabled = false;
      signupBtn.innerText = "Create Account";
    }
  });

});

</script>


</head>

<body class="min-h-screen flex items-center justify-center p-4 bg-white">

<div class="w-full max-w-[500px] bg-white rounded-3xl shadow-xl p-6">

<h1 class="text-center text-2xl font-bold mb-3 text-primary">Create Account</h1>

<p class="text-center text-dark mb-4">Select Your Role</p>

<!-- ===== ROLE CARDS IN ONE LINE ===== -->
 
<div class="flex justify-between gap-4 mb-6">

<div class="role-card border rounded-2xl p-4 text-center cursor-pointer w-1/3" data-role="student">
<span class="material-symbols-outlined text-4xl text-primary">school</span>
<p class="font-bold mt-2">Student</p>
</div>

<div class="role-card border rounded-2xl p-4 text-center cursor-pointer w-1/3" data-role="organizer">
<span class="material-symbols-outlined text-4xl text-primary">business</span>
<p class="font-bold mt-2">Organizer</p>
</div>

<div class="role-card border rounded-2xl p-4 text-center cursor-pointer w-1/3" data-role="admin">
<span class="material-symbols-outlined text-4xl text-primary">person</span>
<p class="font-bold mt-2">Admin</p>
</div>

</div>

<!-- ===== INPUT FIELDS ===== -->
<input id="fullname" placeholder="Full Name" class="w-full p-3 border rounded mb-3"/>

<input id="email" type="email" placeholder="Email" class="w-full p-3 border rounded mb-3"/>

<input id="password" type="password" placeholder="Password" class="w-full p-3 border rounded mb-3"/>

<input id="confirmPassword" type="password" placeholder="Confirm Password" class="w-full p-3 border rounded mb-3"/>

<button id="signupBtn"
class="w-full bg-auth-gradient text-white p-3 rounded-xl font-bold">
Create Account
</button>

<div class="text-center mt-4">
<a href="Login.html" class="text-primary">← Back to Login</a>
</div>

</div>


<!-- ========== SUCCESS POPUP MODAL ========== -->
<div id="successModal"
class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">

  <div class="bg-white rounded-2xl p-6 text-center w-80 shadow-xl">

    <span class="material-symbols-outlined text-green-500 text-5xl mb-3">
      check_circle
    </span>

    <h2 class="text-xl font-bold mb-2">Account Created!</h2>
    <p class="text-gray-600 mb-4">
      Your account was created successfully.<br>
      Redirecting to login...
    </p>


    <button id="goToLoginBtn"
      class="bg-auth-gradient text-white px-6 py-2 rounded-xl font-bold">
      Go to Login
    </button>

  </div>
</div>


</body>
</html>
